
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # 1. REMOVER EXTENSÃO .html (Clean URLs)
  # Se o usuário acessar /turmas.html, redireciona para /turmas
  RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[\s?] [NC]
  RewriteRule ^ /%1 [R=301,L]

  # Se a requisição não for um diretório e existir o .html, serve internamente
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}.html -f
  RewriteRule ^(.+)$ $1.html [L]

  # 2. SPA FALLBACK (React Router)
  # Se o arquivo ou diretório não existir, redireciona para o index.html
  # Isso permite que rotas como /alunos/123 sejam tratadas pelo React
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>

<IfModule mod_headers.c>
  # 3. CONTROLE DE CACHE
  # HTML e JSON: Cache zero para garantir atualizações imediatas no deploy
  <FilesMatch "\.(html|htm|json)$">
    Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
  </FilesMatch>

  # Assets estáticos (JS, CSS, Imagens): Cache agressivo (1 ano)
  # O Vite gera hash nos nomes (ex: main-x8z9.js), então é seguro cachear.
  <FilesMatch "\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
    Header set Cache-Control "max-age=31536000, public, immutable"
  </FilesMatch>
</IfModule>
